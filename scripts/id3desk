#!/bin/zsh
# Hook script to manage a media centric desktop.

# trap "kill \$! > /dev/null 2>&1; exit 1" HUP TERM QUIT INT PIPE

# SCRSIZE=`xwininfo -metric -root | grep -m1 "Height:" | awk '{ print $2; }'`
# [ $SCRSIZE -gt 0 ] || SCRSIZE=768
# MAXSIZE=96
# SIZE=$((($SCRSIZE - 1)/${#IMGS}))
# [ $SIZE -gt $MAXSIZE ] && SIZE=$MAXSIZE;

export SIMVD_SOCKET=${ID3DESK_SIMVD_SOCKET:=/tmp/id3desk-simvd-$DISPLAY}
simvd-client "$1"

if [ "x$1" = "x" ]; then
    clear
    exit 0
fi

title_dump="/tmp/mpd-curtitle-$USER"
mposd_opts=()
rm -f "$title_dump"
tempfile -m 644 -n "$title_dump" > /dev/null && \
    mposd_opts=(--dump "$title_dump")
mposd --columns 102 "${mposd_opts[@]}"

exec id3less "$1"

# while true; do
#     id3less "$1" & wait
#     ncmpc
# done
